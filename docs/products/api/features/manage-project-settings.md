# プロジェクト設定管理

プロジェクト管理者がプロジェクトの設定を管理するための機能です。可視性、デフォルトロールなどのプロジェクト固有の設定を保存・更新します。

## 設定の取得

1. プロジェクト管理者がプロジェクト設定画面にアクセスする
2. システムはプロジェクトIDを使用して関連する全ての設定を取得する
3. 設定が存在しない場合はデフォルト値を使用する
4. 取得した設定をユーザーに表示する

## 設定の更新

1. プロジェクト管理者が設定値を変更する
2. システムはプロジェクトIDと設定キーを使用して既存の設定を検索する
3. 既存の設定が存在する場合は値を更新し、存在しない場合は新規作成する
4. 更新された設定を保存する
5. 成功メッセージをユーザーに表示する

## 設定の削除

1. プロジェクト管理者が設定をデフォルトに戻すアクションを実行する
2. システムはプロジェクトIDと設定キーを使用して既存の設定を検索する
3. 設定が存在する場合は削除する
4. 成功メッセージをユーザーに表示する

## 主要な設定項目

### 可視性設定
- キー: `visibility`
- 値: `"public"`, `"private"`, `"team"`
- デフォルト: `"private"`
- 説明: プロジェクトの可視性を制御します。publicは全ユーザーに公開、privateはメンバーのみ、teamは特定のチームに公開。

### デフォルトロール設定
- キー: `default_role`
- 値: `"MEMBER"`, `"VIEWER"`
- デフォルト: `"VIEWER"`
- 説明: 新しく追加されるメンバーに割り当てられるデフォルトのロールを指定します。

### カスタムフィールド設定
- キー: `custom_fields`
- 値: JSON形式のカスタムフィールド定義
- デフォルト: 空の配列
- 説明: プロジェクト固有のカスタムフィールドを定義します。

## 権限制御

- プロジェクト設定の閲覧は全メンバーが可能
- プロジェクト設定の変更はADMINまたはOWNERロールを持つメンバーのみ可能
- 特定の重要な設定（例: 可視性）の変更はOWNERのみ可能

## エラー処理

- 無効な設定値が提供された場合、適切なエラーメッセージを表示する
- 設定の保存に失敗した場合、エラーメッセージを表示し、前の値に戻す
- 権限がない場合、アクセス拒否エラーを表示する

## セキュリティ考慮事項

- 設定変更は適切な権限チェックを行う
- 設定値はXSS攻撃を防ぐためにサニタイズされる
- 重要な設定変更はログに記録される
