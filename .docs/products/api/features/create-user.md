# ユーザー作成（ユーザー登録）

新規ユーザーがシステムにアカウント登録するためのユースケースです。

## アクター

- 未登録ユーザー

## 前提条件

- ユーザーがシステムにアクセスできる
- ユーザーがまだアカウントを持っていない

## 成功シナリオ

1. ユーザーが登録ページにアクセスする
2. ユーザーがメールアドレスを入力する
3. ユーザーがパスワードを入力する
4. ユーザーが登録ボタンをクリックする
5. システムがメールアドレスの形式を検証する
6. システムがメールアドレスの重複をチェックする
   If (メールアドレスが既に使用されている) Then
     エラーメッセージを表示して処理を中断
   EndIf
7. システムがパスワードの強度を検証する
8. システムが一意のユーザーIDを生成
9. システムがパスワードをハッシュ化
10. システムがユーザーエンティティを作成
11. システムが作成したユーザー情報を保存
12. システムが認証トークンを生成
13. システムが登録完了をユーザーに通知
14. システムがユーザーをログイン状態にする
15. システムがユーザーをダッシュボードページにリダイレクトする

## 代替シナリオ

### メールアドレスが既に使用されている場合

6a. システムがメールアドレスが既に使用されていることを検出する
6b. システムがエラーメッセージを表示する
6c. ユーザーが別のメールアドレスを入力するか、ログインページに移動する

### パスワードが要件を満たさない場合

7a. システムがパスワードが要件を満たさないことを検出する
7b. システムがエラーメッセージを表示する
7c. ユーザーが別のパスワードを入力する

## 例外シナリオ

### システムエラーが発生した場合

10a. システムがユーザーアカウント作成中にエラーが発生する
10b. システムがエラーメッセージを表示する
10c. システムが管理者にエラーを通知する
10d. ユーザーが後で再試行するよう促される

## 入力

- メールアドレス: ユーザーの連絡先および認証に使用
- パスワード: アカウント認証に使用（平文で受け取り、ハッシュ化して保存）

## 出力

- 作成されたユーザーエンティティ
- エラー：内部エラーが発生した場合はInternalエラー

## ビジネスルール

- メールアドレスは有効な形式でなければならない
- メールアドレスはシステム内で一意でなければならない
- パスワードは最低8文字以上で、少なくとも1つの数字、1つの大文字、1つの小文字、1つの特殊文字を含む必要がある
- ユーザーIDはUUID形式で自動生成される
- ユーザー名は初期値としてメールアドレスのローカル部分が使用される

## 関連モデル

- [ユーザー](../entities/user.md)