# ユーザー設定管理

ユーザーが自身の設定を管理するための機能です。テーマ、言語設定などのユーザー固有の設定を保存・更新します。

## 設定の取得

1. ユーザーが設定画面にアクセスする
2. システムはユーザーIDを使用して関連する全ての設定を取得する
3. 設定が存在しない場合はデフォルト値を使用する
4. 取得した設定をユーザーに表示する

## 設定の更新

1. ユーザーが設定値を変更する
2. システムはユーザーIDと設定キーを使用して既存の設定を検索する
3. 既存の設定が存在する場合は値を更新し、存在しない場合は新規作成する
4. 更新された設定を保存する
5. 成功メッセージをユーザーに表示する

## 設定の削除

1. ユーザーが設定をデフォルトに戻すアクションを実行する
2. システムはユーザーIDと設定キーを使用して既存の設定を検索する
3. 設定が存在する場合は削除する
4. 成功メッセージをユーザーに表示する

## 主要な設定項目

### テーマ設定
- キー: `theme`
- 値: `"light"` または `"dark"`
- デフォルト: システムのデフォルト設定に従う

### 言語設定
- キー: `language`
- 値: 言語コード（例: `"ja"`, `"en"`）
- デフォルト: ブラウザの言語設定

### タイムゾーン設定
- キー: `timezone`
- 値: タイムゾーン識別子（例: `"Asia/Tokyo"`）
- デフォルト: システムのデフォルトタイムゾーン

## エラー処理

- 無効な設定値が提供された場合、適切なエラーメッセージを表示する
- 設定の保存に失敗した場合、エラーメッセージを表示し、前の値に戻す
- 権限がない場合（他のユーザーの設定を変更しようとした場合など）、アクセス拒否エラーを表示する

## セキュリティ考慮事項

- ユーザーは自分自身の設定のみを変更可能
- 管理者は他のユーザーの設定を閲覧・変更可能（管理機能として）
- 設定値はXSS攻撃を防ぐためにサニタイズされる
